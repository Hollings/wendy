<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wendy Avatar</title>
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>
    <!-- Auth screen -->
    <div id="auth-screen" class="screen fullscreen">
        <div class="auth-box">
            <h1>Wendy's Room</h1>
            <p>Enter the code to watch Wendy work</p>
            <form id="auth-form">
                <input type="text" id="code-input" placeholder="Code" autocomplete="off" autofocus>
                <button type="submit">Enter</button>
            </form>
            <div id="auth-error"></div>
        </div>
    </div>

    <!-- Main 3D scene wrapper -->
    <div id="scene-wrapper" class="hidden">
        <div id="scene-container">
            <!-- Three.js canvas will be inserted here -->

            <!-- Camera preset buttons -->
            <div id="camera-buttons">
                <button onclick="setCameraPreset(0)">Over Shoulder</button>
                <button onclick="setCameraPreset(1)">Face</button>
                <button onclick="setCameraPreset(2)">Keyboard</button>
                <button onclick="setCameraPreset(3)">Computer</button>
            </div>



        <!-- Debug panel -->
        <div id="debug-panel" class="hidden">
            <div style="margin-bottom: 8px;">State: <span id="debug-state">idle</span></div>
            <div class="state-buttons">
                <button onclick="triggerState('idle')">idle</button>
                <button onclick="triggerState('waking')">waking</button>
                <button onclick="triggerState('check_messages')">check_messages</button>
                <button onclick="triggerState('thinking')">thinking</button>
                <button onclick="triggerState('terminal')">terminal</button>
                <button onclick="triggerState('editing')">editing</button>
                <button onclick="triggerState('read_file')">read_file</button>
                <button onclick="triggerState('send_message')">send_message</button>
                <button onclick="triggerState('done')">done</button>
            </div>
            <div style="margin-top: 8px; font-size: 11px;">
                <div>Cam: <span id="debug-camera">-</span></div>
                <button onclick="cycleCamera()" style="margin-top: 4px;">Next View</button>
            </div>
        </div>


        <!-- IK Debug Panel -->
        <div id="ik-panel" class="hidden">
            <div class="tuner-header">
                <strong>IK Target</strong>
                <label><input type="checkbox" id="ik-enabled" checked> Enable</label>
            </div>
            <div class="tuner-section">
                <label>X: <span id="ik-x-val">0.30</span></label>
                <input type="range" id="ik-x" min="-1" max="1" step="0.01" value="0.30">
                <label>Y: <span id="ik-y-val">0.20</span></label>
                <input type="range" id="ik-y" min="-0.5" max="1" step="0.01" value="0.20">
                <label>Z: <span id="ik-z-val">0.40</span></label>
                <input type="range" id="ik-z" min="-0.5" max="1" step="0.01" value="0.40">
            </div>
            <div class="tuner-section">
                <div><strong>Pole (elbow hint)</strong></div>
                <label>X: <span id="pole-x-val">0.50</span></label>
                <input type="range" id="pole-x" min="-1" max="1" step="0.01" value="0.50">
                <label>Y: <span id="pole-y-val">0.30</span></label>
                <input type="range" id="pole-y" min="-1" max="1" step="0.01" value="0.30">
                <label>Z: <span id="pole-z-val">-0.50</span></label>
                <input type="range" id="pole-z" min="-1" max="1" step="0.01" value="-0.50">
            </div>
            <div class="tuner-section">
                <label>Arm:
                    <select id="ik-arm">
                        <option value="right">Right</option>
                        <option value="left">Left</option>
                    </select>
                </label>
            </div>
        </div>

        <!-- Scene positioning panel -->
        <div id="scene-tuner" class="hidden">
            <div class="tuner-header">
                <strong>Scene Tuner</strong>
                <button onclick="window.toggleSceneTuner()">X</button>
            </div>
            <div class="tuner-section">
                <div><strong>Camera Target</strong></div>
                <label>X: <span id="cam-target-x-val">0</span></label>
                <input type="range" id="cam-target-x" min="-5" max="5" step="0.1" value="0">
                <label>Y: <span id="cam-target-y-val">1</span></label>
                <input type="range" id="cam-target-y" min="0" max="5" step="0.1" value="1">
                <label>Z: <span id="cam-target-z-val">0</span></label>
                <input type="range" id="cam-target-z" min="-5" max="5" step="0.1" value="0">
            </div>
            <div class="tuner-output">
                <button onclick="window.copySceneValues()">Copy Values</button>
                <pre id="scene-tuner-output"></pre>
            </div>
        </div>
        <button id="scene-tuner-toggle" class="hidden" onclick="window.toggleSceneTuner()">Tune Scene</button>

        <!-- Thought Bubble - positioned above Wendy's head -->
        <div id="thought-bubble" class="hidden">
            <div id="thought-text"></div>
        </div>

        <!-- Scene Object Debug Menu -->
        <button id="object-debug-toggle" onclick="window.toggleObjectDebug()">Objects</button>
        <div id="object-debug-panel" class="hidden">
            <div class="debug-header">
                <strong>Scene Objects</strong>
                <button onclick="window.toggleObjectDebug()">X</button>
            </div>
            <div id="object-list">
                <!-- Populated by JavaScript -->
            </div>
            <div class="debug-footer">
                <button onclick="window.exportScenePositions()">Export JSON</button>
                <button onclick="window.copyScenePositions()">Copy</button>
            </div>
            <pre id="object-debug-output"></pre>
        </div>
        </div>
    </div>

    <!-- Load Three.js from CDN -->
    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
        }
    }
    </script>

    <!-- App modules -->
    <script type="module" src="src/main.js"></script>
</body>
</html>
